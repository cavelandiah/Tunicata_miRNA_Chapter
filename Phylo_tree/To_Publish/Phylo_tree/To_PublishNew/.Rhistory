library("ape")
library("Biostrings")
library("ggplot2")
library("ggtree")
library("ggtree")
nwk <- read.tree("metazoa.Ensembl.Bilateria_final.nwk")
reference  <- ggtree(nwk, layout="circular") + geom_tiplab2(size=3, color="black") + geom_text2(aes(subset=!isTip, label=node, hjust=-.3))
reference
nwk <- read.tree("metazoa.Ensembl.Bilateria_final.nwk")
reference  <- ggtree(nwk, layout="circular") + geom_tiplab2(size=3, color="black") + geom_text2(aes(subset=!isTip, label=node, hjust=-.3))
reference
reference  <- ggtree(nwk, layout="circular") + geom_tiplab2(size=3, color="black") + geom_text2(aes(subset=!isTip, label=node, hjust=-.3, size=5))
reference
reference  <- ggtree(nwk, layout="circular") + geom_tiplab2(size=6, color="black") + geom_text2(aes(subset=!isTip, label=node, hjust=-.3, size=6))
reference
dd <- read.table("data_table_progam_count", header=T)

reference <- reference %<+% dd
reference
reference + geom_text(aes(label=Name), hjust=-0.5)
reference
reference + geom_text(aes(color='green', label=Gains), hjust=1, vjust=-0.4, size=3)
reference + geom_text(color='green', aes(label=Gains), hjust=1, vjust=-0.4, size=3)
reference + geom_text(color='green', aes(label=Gains), hjust=1, vjust=-0.4, size=3) + geom_text(color='red', aes(label=Loss), hjust=1, vjust=1.4, size=3)
reference  <- ggtree(nwk, layout="circular") + geom_tiplab2(size=6, color="black")
reference <- reference %<+% dd
reference + geom_text(color='green', aes(label=Gains), hjust=1, vjust=-0.4, size=3) + geom_text(color='red', aes(label=Loss), hjust=1, vjust=1.4, size=3)
reference + geom_text(color='green', aes(label=Gains), hjust=1, vjust=-0.4, size=6) + geom_text(color='red', aes(label=Loss), hjust=1, vjust=1.4, size=6)
reference  <- ggtree(nwk) + geom_tiplab2(size=6, color="black")
reference <- reference %<+% dd
reference + geom_text(color='green', aes(label=Gains), hjust=1, vjust=-0.4, size=6) + geom_text(color='red', aes(label=Loss), hjust=1, vjust=1.4, size=6)
reference  <- ggtree(nwk, layout="circular") + geom_tiplab(size=6, color="black")
reference <- reference %<+% dd
reference + geom_text(color='green', aes(label=Gains), hjust=1, vjust=-0.4, size=6) + geom_text(color='red', aes(label=Loss), hjust=1, vjust=1.4, size=6)
reference  <- ggtree(nwk, layout="circular") + geom_tiplab(size=6, color="black")
reference <- reference %<+% dd
reference + geom_text(color='green', aes(label=Gains), hjust=1, vjust=-0.4, size=6) + geom_text(color='red', aes(label=Loss), hjust=1, vjust=1.4, size=6)
reference  <- ggtree(nwk) + geom_tiplab(size=6, color="black")
reference <- reference %<+% dd
reference + geom_text(color='green', aes(label=Gains), hjust=1, vjust=-0.4, size=6) + geom_text(color='red', aes(label=Loss), hjust=1, vjust=1.4, size=6)
reference  <- ggtree(nwk) + geom_tiplab(size=3, color="black") + geom_text2(aes(subset=!isTip, label=node, hjust=-.3, size=3))
reference <- reference %<+% dd
reference + geom_text(color='green', aes(label=Gains), hjust=1, vjust=-0.4, size=6) + geom_text(color='red', aes(label=Loss), hjust=1, vjust=1.4, size=6) + geom_cladelabel(node=)
reference + geom_text(color='green', aes(label=Gains), hjust=1, vjust=-0.4, size=6) + geom_text(color='red', aes(label=Loss), hjust=1, vjust=1.4, size=6)
reference + geom_text(color='green', aes(label=Gains), hjust=1, vjust=-0.4, size=6) + geom_text(color='red', aes(label=Loss), hjust=1, vjust=1.4, size=6) + geom_cladelabel(node=33, label="Stolidobranchia", align=T, offset=.5)
reference + geom_text(color='green', aes(label=Gains), hjust=1, vjust=-0.4, size=6) + geom_text(color='red', aes(label=Loss), hjust=1, vjust=1.4, size=6) + geom_cladelabel(node=33, label="Stolidobranchia", align=T, offset=.5) + geom_cladelabel(node=29, label="Phlebobranchia", align=T, offset=.5)
reference  <- ggtree(nwk) + geom_tiplab(size=5, color="black") + geom_text2(aes(subset=!isTip, label=node, hjust=-.3, size=3))
reference <- reference %<+% dd
reference + geom_text(color='green', aes(label=Gains), hjust=1, vjust=-0.4, size=6) + geom_text(color='red', aes(label=Loss), hjust=1, vjust=1.4, size=6) + geom_cladelabel(node=33, label="Stolidobranchia", align=T, offset=.5) + geom_cladelabel(node=29, label="Phlebobranchia", align=T, offset=.5)
reference + geom_text(color='green', aes(label=Gains), hjust=1, vjust=-0.4, size=6) + geom_text(color='red', aes(label=Loss), hjust=1, vjust=1.4, size=6) + geom_cladelabel(node=33, label="Stolidobranchia", align=T, offset=.5) + geom_cladelabel(node=29, label="Phlebobranchia", align=T, offset=.5) + geom_cladelabel(node=26, label="Aplousobranchia", align=T, offset=.5)
reference + geom_text(color='green', aes(label=Gains), hjust=1, vjust=-0.4, size=6) + geom_text(color='red', aes(label=Loss), hjust=1, vjust=1.4, size=6) + geom_cladelabel(node=33, label="Stolidobranchia", align=T, offset=.5) + geom_cladelabel(node=29, label="Phlebobranchia", align=T, offset=.5) + geom_cladelabel(node=25, label="Aplousobranchia", align=T, offset=.5)
reference + geom_text(color='green', aes(label=Gains), hjust=1, vjust=-0.4, size=6) + geom_text(color='red', aes(label=Loss), hjust=1, vjust=1.4, size=6) + geom_cladelabel(node=33, label="Stolidobranchia", align=T, offset=.5) + geom_cladelabel(node=29, label="Phlebobranchia", align=T, offset=.5) + geom_cladelabel(node=28, label="Aplousobranchia", align=T, offset=.5)
reference + geom_text(color='green', aes(label=Gains), hjust=1, vjust=-0.4, size=6) + geom_text(color='red', aes(label=Loss), hjust=1, vjust=1.4, size=6) + geom_cladelabel(node=33, label="Stolidobranchia", align=T, offset=.5) + geom_cladelabel(node=29, label="Phlebobranchia", align=T, offset=.5) + geom_cladelabel(node=28, label="Aplousobranchia", align=T, offset=.5) + geom_cladelabel(node=32, label="Thaliacea", align=T, offset=.5)
reference + geom_text(color='green', aes(label=Gains), hjust=1, vjust=-0.4, size=6) + geom_text(color='red', aes(label=Loss), hjust=1, vjust=1.4, size=6) + geom_cladelabel(node=33, label="Stolidobranchia", align=T, offset=.5) + geom_cladelabel(node=29, label="Phlebobranchia", align=T, offset=.5) + geom_cladelabel(node=28, label="Aplousobranchia", align=T, offset=.5) + geom_cladelabel(node=32, label="Thaliacea", align=T, offset=.5) + geom_cladelabel(node=24, label="Appendicularia", align=T, offset=.5)
reference + geom_text(color='green', aes(label=Gains), hjust=1, vjust=-0.4, size=6) + geom_text(color='red', aes(label=Loss), hjust=1, vjust=1.4, size=6) + geom_cladelabel(node=33, label="Stolidobranchia", align=T, offset=.5) + geom_cladelabel(node=29, label="Phlebobranchia", align=T, offset=.5) + geom_cladelabel(node=28, label="Aplousobranchia", align=T, offset=.5) + geom_cladelabel(node=32, label="Thaliacea", align=T, offset=.5) + geom_cladelabel(node=24, label="Appendicularia", align=T, offset=.5) + geom_cladelabel(node=42, label="Vertebrata", align=T, offset=.5)
reference + geom_text(color='green', aes(label=Gains), hjust=1, vjust=-0.4, size=6) + geom_text(color='red', aes(label=Loss), hjust=1, vjust=1.4, size=6) + geom_cladelabel(node=33, label="Stolidobranchia", align=T, offset=.5) + geom_cladelabel(node=29, label="Phlebobranchia", align=T, offset=.5) + geom_cladelabel(node=28, label="Aplousobranchia", align=T, offset=.5) + geom_cladelabel(node=32, label="Thaliacea", align=T, offset=.5) + geom_cladelabel(node=24, label="Appendicularia", align=T, offset=.5) + geom_cladelabel(node=42, label="Vertebrata", align=T, offset=.5) + geom_cladelabel(node=21, label="Cephalochordata", align=T, offset=.5)
reference + geom_text(color='green', aes(label=Gains), hjust=1, vjust=-0.4, size=6) + geom_text(color='red', aes(label=Loss), hjust=1, vjust=1.4, size=6) + geom_cladelabel(node=33, label="Stolidobranchia", align=T, offset=.5) + geom_cladelabel(node=29, label="Phlebobranchia", align=T, offset=.5) + geom_cladelabel(node=28, label="Aplousobranchia", align=T, offset=.5) + geom_cladelabel(node=32, label="Thaliacea", align=T, offset=.5) + geom_cladelabel(node=24, label="Appendicularia", align=T, offset=.5) + geom_cladelabel(node=42, label="Vertebrata", align=T, offset=.5, solor='blue') + geom_cladelabel(node=21, label="Cephalochordata", align=T, offset=.5)
reference + geom_text(color='green', aes(label=Gains), hjust=1, vjust=-0.4, size=6) + geom_text(color='red', aes(label=Loss), hjust=1, vjust=1.4, size=6) + geom_cladelabel(node=33, label="Stolidobranchia", align=T, offset=.5) + geom_cladelabel(node=29, label="Phlebobranchia", align=T, offset=.5) + geom_cladelabel(node=28, label="Aplousobranchia", align=T, offset=.5) + geom_cladelabel(node=32, label="Thaliacea", align=T, offset=.5) + geom_cladelabel(node=24, label="Appendicularia", align=T, offset=.5) + geom_cladelabel(node=42, label="Vertebrata", align=T, offset=.5, color='blue') + geom_cladelabel(node=21, label="Cephalochordata", align=T, offset=.5)
reference + geom_text(color='green', aes(label=Gains), hjust=1, vjust=-0.4, size=6) + geom_text(color='red', aes(label=Loss), hjust=1, vjust=1.4, size=6) + geom_cladelabel(node=33, label="Stolidobranchia", align=T, offset=.5, color='yellow') + geom_cladelabel(node=29, label="Phlebobranchia", align=T, offset=.5, color='green') + geom_cladelabel(node=28, label="Aplousobranchia", align=T, offset=.5, color='blue') + geom_cladelabel(node=32, label="Thaliacea", align=T, offset=.5, color='red') + geom_cladelabel(node=24, label="Appendicularia", align=T, offset=.5, color='pink') + geom_cladelabel(node=42, label="Vertebrata", align=T, offset=.5, color='grey') + geom_cladelabel(node=21, label="Cephalochordata", align=T, offset=.5)
reference + geom_text(color='green', aes(label=Gains), hjust=1, vjust=-0.4, size=6) + geom_text(color='red', aes(label=Loss), hjust=1, vjust=1.4, size=6) + geom_cladelabel(node=33, label="Stolidobranchia", align=T, offset=.5, color='yellow') + geom_cladelabel(node=29, label="Phlebobranchia", align=T, offset=.5, color='green') + geom_cladelabel(node=28, label="Aplousobranchia", align=T, offset=.5, color='blue') + geom_cladelabel(node=32, label="Thaliacea", align=T, offset=.5, color='red') + geom_cladelabel(node=24, label="Appendicularia", align=T, offset=.5, color='pink') + geom_cladelabel(node=42, label="Vertebrata", align=T, offset=.5, color='grey') + geom_cladelabel(node=21, label="Cephalochordata", align=T, offset=.5, color='grey')
reference + geom_text(color='green', aes(label=Gains), hjust=1, vjust=-0.4, size=6) + geom_text(color='red', aes(label=Loss), hjust=1, vjust=1.4, size=6) + geom_cladelabel(node=33, label="Stolidobranchia", align=T, offset=.5, color='yellow') + geom_cladelabel(node=29, label="Phlebobranchia", align=T, offset=.5, color='green') + geom_cladelabel(node=28, label="Aplousobranchia", align=T, offset=.5, color='blue') + geom_cladelabel(node=32, label="Thaliacea", align=T, offset=.5, color='red') + geom_cladelabel(node=24, label="Appendicularia", align=T, offset=.5, color='pink') + geom_cladelabel(node=42, label="Vertebrata", align=T, offset=.5, color='grey') + geom_cladelabel(node=21, label="Cephalochordata", align=T, offset=.5, color='grey') + geom_cladelabel(node=23, label="Tunicata", color='red', offset=.10)
reference + geom_text(color='green', aes(label=Gains), hjust=1, vjust=-0.4, size=6) + geom_text(color='red', aes(label=Loss), hjust=1, vjust=1.4, size=6) + geom_cladelabel(node=33, label="Stolidobranchia", align=T, offset=.5, color='yellow') + geom_cladelabel(node=29, label="Phlebobranchia", align=T, offset=.5, color='green') + geom_cladelabel(node=28, label="Aplousobranchia", align=T, offset=.5, color='blue') + geom_cladelabel(node=32, label="Thaliacea", align=T, offset=.5, color='red') + geom_cladelabel(node=24, label="Appendicularia", align=T, offset=.5, color='pink') + geom_cladelabel(node=42, label="Vertebrata", align=T, offset=.5, color='grey') + geom_cladelabel(node=21, label="Cephalochordata", align=T, offset=.5, color='grey') + geom_cladelabel(node=23, label="Tunicata", color='red', offset=-.10)
reference + geom_text(color='green', aes(label=Gains), hjust=1, vjust=-0.4, size=6) + geom_text(color='red', aes(label=Loss), hjust=1, vjust=1.4, size=6) + geom_cladelabel(node=33, label="Stolidobranchia", align=T, offset=.5, color='yellow') + geom_cladelabel(node=29, label="Phlebobranchia", align=T, offset=.5, color='green') + geom_cladelabel(node=28, label="Aplousobranchia", align=T, offset=.5, color='blue') + geom_cladelabel(node=32, label="Thaliacea", align=T, offset=.5, color='red') + geom_cladelabel(node=24, label="Appendicularia", align=T, offset=.5, color='pink') + geom_cladelabel(node=42, label="Vertebrata", align=T, offset=.5, color='grey') + geom_cladelabel(node=21, label="Cephalochordata", align=T, offset=.5, color='grey')
reference + geom_text(color='green', aes(label=Gains), hjust=1, vjust=-0.4, size=6) + geom_text(color='red', aes(label=Loss), hjust=1, vjust=1.4, size=6) + geom_cladelabel(node=33, label="Stolidobranchia", align=T, offset=.5, color='brown') + geom_cladelabel(node=29, label="Phlebobranchia", align=T, offset=.5, color='green') + geom_cladelabel(node=28, label="Aplousobranchia", align=T, offset=.5, color='blue') + geom_cladelabel(node=32, label="Thaliacea", align=T, offset=.5, color='red') + geom_cladelabel(node=24, label="Appendicularia", align=T, offset=.5, color='pink') + geom_cladelabel(node=42, label="Vertebrata", align=T, offset=.5, color='grey') + geom_cladelabel(node=21, label="Cephalochordata", align=T, offset=.5, color='grey')
dd <- read.table("data_table_progam_count", header=T)
reference  <- ggtree(nwk) + geom_tiplab(size=5, color="black") + geom_text2(aes(subset=!isTip, label=node, hjust=-.3, size=3))
reference <- reference %<+% dd
reference + geom_text(color='green', aes(label=Gains), hjust=1, vjust=-0.4, size=6) + geom_text(color='red', aes(label=Loss), hjust=1, vjust=1.4, size=6) + geom_cladelabel(node=33, label="Stolidobranchia", align=T, offset=.5, color='brown') + geom_cladelabel(node=29, label="Phlebobranchia", align=T, offset=.5, color='green') + geom_cladelabel(node=28, label="Aplousobranchia", align=T, offset=.5, color='blue') + geom_cladelabel(node=32, label="Thaliacea", align=T, offset=.5, color='red') + geom_cladelabel(node=24, label="Appendicularia", align=T, offset=.5, color='pink') + geom_cladelabel(node=42, label="Vertebrata", align=T, offset=.5, color='grey') + geom_cladelabel(node=21, label="Cephalochordata", align=T, offset=.5, color='grey')
reference  <- ggtree(nwk) + geom_tiplab(size=5, color="black", aes(size=Total)) + geom_text2(aes(subset=!isTip, label=node, hjust=-.3, size=3))
reference + geom_text(color='green', aes(label=Gains), hjust=1, vjust=-0.4, size=6) + geom_text(color='red', aes(label=Loss), hjust=1, vjust=1.4, size=6) + geom_cladelabel(node=33, label="Stolidobranchia", align=T, offset=.5, color='brown') + geom_cladelabel(node=29, label="Phlebobranchia", align=T, offset=.5, color='green') + geom_cladelabel(node=28, label="Aplousobranchia", align=T, offset=.5, color='blue') + geom_cladelabel(node=32, label="Thaliacea", align=T, offset=.5, color='red') + geom_cladelabel(node=24, label="Appendicularia", align=T, offset=.5, color='pink') + geom_cladelabel(node=42, label="Vertebrata", align=T, offset=.5, color='grey') + geom_cladelabel(node=21, label="Cephalochordata", align=T, offset=.5, color='grey')
reference  <- ggtree(nwk) + geom_tiplab(size=5, color="black", aes(size=Total)) + geom_text2(aes(subset=!isTip, label=node, hjust=-.3, size=3))
reference <- reference %<+% dd
reference  <- ggtree(nwk) + geom_tiplab(size=5, color="black", aes(size=Total)) + geom_text2(aes(subset=!isTip, label=node, hjust=-.3, size=3))
reference  <- ggtree(nwk) + geom_tiplab(size=5, color="black", aes(size=Total)) + geom_text2(aes(subset=!isTip, label=node, hjust=-.3, size=3))
reference <- reference %<+% dd
reference + geom_text(color='green', aes(label=Gains), hjust=1, vjust=-0.4, size=6) + geom_text(color='red', aes(label=Loss), hjust=1, vjust=1.4, size=6) + geom_cladelabel(node=33, label="Stolidobranchia", align=T, offset=.5, color='brown') + geom_cladelabel(node=29, label="Phlebobranchia", align=T, offset=.5, color='green') + geom_cladelabel(node=28, label="Aplousobranchia", align=T, offset=.5, color='blue') + geom_cladelabel(node=32, label="Thaliacea", align=T, offset=.5, color='red') + geom_cladelabel(node=24, label="Appendicularia", align=T, offset=.5, color='pink') + geom_cladelabel(node=42, label="Vertebrata", align=T, offset=.5, color='grey') + geom_cladelabel(node=21, label="Cephalochordata", align=T, offset=.5, color='grey')
reference  <- ggtree(nwk) + geom_tiplab(size=5, color="black") + geom_text2(aes(subset=!isTip, label=node, hjust=-.3, size=3))
reference <- reference %<+% dd
reference + geom_text(color='green', aes(label=Gains), hjust=1, vjust=-0.4, size=6) + geom_text(color='red', aes(label=Loss), hjust=1, vjust=1.4, size=6) + geom_cladelabel(node=33, label="Stolidobranchia", align=T, offset=.5, color='brown') + geom_cladelabel(node=29, label="Phlebobranchia", align=T, offset=.5, color='green') + geom_cladelabel(node=28, label="Aplousobranchia", align=T, offset=.5, color='blue') + geom_cladelabel(node=32, label="Thaliacea", align=T, offset=.5, color='red') + geom_cladelabel(node=24, label="Appendicularia", align=T, offset=.5, color='pink') + geom_cladelabel(node=42, label="Vertebrata", align=T, offset=.5, color='grey') + geom_cladelabel(node=21, label="Cephalochordata", align=T, offset=.5, color='grey') + geom_tippoint(aes(label=Total))
reference + geom_text(color='green', aes(label=Gains), hjust=1, vjust=-0.4, size=6) + geom_text(color='red', aes(label=Loss), hjust=1, vjust=1.4, size=6) + geom_cladelabel(node=33, label="Stolidobranchia", align=T, offset=.5, color='brown') + geom_cladelabel(node=29, label="Phlebobranchia", align=T, offset=.5, color='green') + geom_cladelabel(node=28, label="Aplousobranchia", align=T, offset=.5, color='blue') + geom_cladelabel(node=32, label="Thaliacea", align=T, offset=.5, color='red') + geom_cladelabel(node=24, label="Appendicularia", align=T, offset=.5, color='pink') + geom_cladelabel(node=42, label="Vertebrata", align=T, offset=.5, color='grey') + geom_cladelabel(node=21, label="Cephalochordata", align=T, offset=.5, color='grey') + geom_tippoint(aes(size=Total))
dd
reference + geom_text(color='green', aes(label=Gains), hjust=1, vjust=-0.4, size=6) + geom_text(color='red', aes(label=Loss), hjust=1, vjust=1.4, size=6) + geom_cladelabel(node=33, label="Stolidobranchia", align=T, offset=.5, color='brown') + geom_cladelabel(node=29, label="Phlebobranchia", align=T, offset=.5, color='green') + geom_cladelabel(node=28, label="Aplousobranchia", align=T, offset=.5, color='blue') + geom_cladelabel(node=32, label="Thaliacea", align=T, offset=.5, color='red') + geom_cladelabel(node=24, label="Appendicularia", align=T, offset=.5, color='pink') + geom_cladelabel(node=42, label="Vertebrata", align=T, offset=.5, color='grey') + geom_cladelabel(node=21, label="Cephalochordata", align=T, offset=.5, color='grey') + geom_tippoint(aes(size=Total, color='red'))
reference + geom_text(color='green', aes(label=Gains), hjust=1, vjust=-0.4, size=6) + geom_text(color='red', aes(label=Loss), hjust=1, vjust=1.4, size=6) + geom_cladelabel(node=33, label="Stolidobranchia", align=T, offset=.5, color='brown') + geom_cladelabel(node=29, label="Phlebobranchia", align=T, offset=.5, color='green') + geom_cladelabel(node=28, label="Aplousobranchia", align=T, offset=.5, color='blue') + geom_cladelabel(node=32, label="Thaliacea", align=T, offset=.5, color='red') + geom_cladelabel(node=24, label="Appendicularia", align=T, offset=.5, color='pink') + geom_cladelabel(node=42, label="Vertebrata", align=T, offset=.5, color='grey') + geom_cladelabel(node=21, label="Cephalochordata", align=T, offset=.5, color='grey') + geom_tippoint(aes(size=Total), color='red'))
reference + geom_text(color='green', aes(label=Gains), hjust=1, vjust=-0.4, size=6) + geom_text(color='red', aes(label=Loss), hjust=1, vjust=1.4, size=6) + geom_cladelabel(node=33, label="Stolidobranchia", align=T, offset=.5, color='brown') + geom_cladelabel(node=29, label="Phlebobranchia", align=T, offset=.5, color='green') + geom_cladelabel(node=28, label="Aplousobranchia", align=T, offset=.5, color='blue') + geom_cladelabel(node=32, label="Thaliacea", align=T, offset=.5, color='red') + geom_cladelabel(node=24, label="Appendicularia", align=T, offset=.5, color='pink') + geom_cladelabel(node=42, label="Vertebrata", align=T, offset=.5, color='grey') + geom_cladelabel(node=21, label="Cephalochordata", align=T, offset=.5, color='grey') + geom_tippoint(aes(size=Total), color='red')
reference + geom_text(color='green', aes(label=Gains), hjust=1, vjust=-0.4, size=6) + geom_text(color='red', aes(label=Loss), hjust=1, vjust=1.4, size=6) + geom_cladelabel(node=33, label="Stolidobranchia", align=T, offset=.5, color='brown') + geom_cladelabel(node=29, label="Phlebobranchia", align=T, offset=.5, color='green') + geom_cladelabel(node=28, label="Aplousobranchia", align=T, offset=.5, color='blue') + geom_cladelabel(node=32, label="Thaliacea", align=T, offset=.5, color='red') + geom_cladelabel(node=24, label="Appendicularia", align=T, offset=.5, color='pink') + geom_cladelabel(node=42, label="Vertebrata", align=T, offset=.5, color='grey') + geom_cladelabel(node=21, label="Cephalochordata", align=T, offset=.5, color='grey')
reference + geom_text(color='green', aes(label=Gains), hjust=1, vjust=-0.4, size=6) + geom_text(color='red', aes(label=Loss), hjust=1, vjust=1.4, size=6) + geom_cladelabel(node=33, label="Stolidobranchia", align=T, offset=.5, color='brown') + geom_cladelabel(node=29, label="Phlebobranchia", align=T, offset=.5, color='green') + geom_cladelabel(node=28, label="Aplousobranchia", align=T, offset=.5, color='blue') + geom_cladelabel(node=32, label="Thaliacea", align=T, offset=.5, color='red') + geom_cladelabel(node=24, label="Appendicularia", align=T, offset=.5, color='pink') + geom_cladelabel(node=42, label="Vertebrata", align=T, offset=.5, color='grey') + geom_cladelabel(node=21, label="Cephalochordata", align=T, offset=.5, color='grey') + geom_tiplab(aes(label=Total)) + geom_tippoint(aes(size=Total), color='red')
reference + geom_text(color='green', aes(label=Gains), hjust=1, vjust=-0.4, size=6) + geom_text(color='red', aes(label=Loss), hjust=1, vjust=1.4, size=6) + geom_cladelabel(node=33, label="Stolidobranchia", align=T, offset=.5, color='brown') + geom_cladelabel(node=29, label="Phlebobranchia", align=T, offset=.5, color='green') + geom_cladelabel(node=28, label="Aplousobranchia", align=T, offset=.5, color='blue') + geom_cladelabel(node=32, label="Thaliacea", align=T, offset=.5, color='red') + geom_cladelabel(node=24, label="Appendicularia", align=T, offset=.5, color='pink') + geom_cladelabel(node=42, label="Vertebrata", align=T, offset=.5, color='grey') + geom_cladelabel(node=21, label="Cephalochordata", align=T, offset=.5, color='grey') + geom_tiplab(aes(color=Total)) + geom_tippoint(aes(size=Total), color='red')
bars <-nodebar(dd, cols=3:4)
inset(reference, bars)
dat(3:4)
dd(3:4)
dd[3:4]
bars <-nodebar(dd, cols=3:4, position="dodge", colors=c(Gains='green', Loss='red'))
bars <-nodebar(dd, cols=3:4, position="dodge", colors=c(Gains='green', Loss='red')))
bars <-nodebar(dd, cols=3:4, position="dodge", color=c(Gains='green', Loss='red'))
dd[3:4]
inset(reference, bars)
inset(reference, bars, x='branch')
inset(reference, bars, x='branch', width=.07, vjust=-.3)
inset(reference, bars, x="branch", width=.07, vjust=-.3)
dd <- read.table("data_table_progam_count", header=T)
reference <- reference %<+% dd
dd
reference  <- ggtree(nwk) + geom_tiplab(size=5, color="black") + geom_text2(aes(subset=!isTip, label=node, hjust=-.3, size=3))
reference <- reference %<+% dd
bars <-nodebar(dd, cols=3:4, position="dodge", color=c(Gains='green', Loss='red'))
inset(reference, bars, x="branch", width=.07, vjust=-.3)
?nodebar
?inset
inset(reference, bars, x="node", width=.07, vjust=-.3)
inset(reference, bars, x="branch", width=.07, heigth=0.02)
?inset
inset(reference, bars, x="branch", width=.07, height=0.02)
inset(reference, bars, x="branch", width=.07, height=0.2)
inset(reference, bars, x="branch", width=.07, height=0.05)
inset(reference, bars, x="branch", width=.07, height=0.05. reverse_y=T)
inset(reference, bars, x="branch", width=.07, height=0.05, reverse_y=T)
inset(reference, bars, x="branch", width=.07, height=0.05. reverse_x=T)
inset(reference, bars, x="branch", width=.07, height=0.05, reverse_x=T)
inset(reference, bars, x="branch", width=.07, height=0.05)
inset(reference, bars, x="branch", width=.07, height=0.05, hjust=-.3)
inset(reference, bars, x="branch", width=.07, height=0.05, vjust=-.3)
reference + geom_text(color='green', aes(label=Gains), hjust=1, vjust=-0.4, size=6) + geom_text(color='red', aes(label=Loss), hjust=1, vjust=1.4, size=6) + geom_cladelabel(node=33, label="Stolidobranchia", align=T, offset=.5, color='brown') + geom_cladelabel(node=29, label="Phlebobranchia", align=T, offset=.5, color='green') + geom_cladelabel(node=28, label="Aplousobranchia", align=T, offset=.5, color='blue') + geom_cladelabel(node=32, label="Thaliacea", align=T, offset=.5, color='red') + geom_cladelabel(node=24, label="Appendicularia", align=T, offset=.5, color='pink') + geom_cladelabel(node=42, label="Vertebrata", align=T, offset=.5, color='grey') + geom_cladelabel(node=21, label="Cephalochordata", align=T, offset=.5, color='grey') + geom_tippoint(aes(size=Total))
reference  <- ggtree(nwk) + geom_tiplab(size=5, color="black") + geom_text2(aes(subset=!isTip, label=Total, hjust=-.3, size=3))
reference <- reference %<+% dd
reference + geom_text(color='green', aes(label=Gains), hjust=1, vjust=-0.4, size=6) + geom_text(color='red', aes(label=Loss), hjust=1, vjust=1.4, size=6) + geom_cladelabel(node=33, label="Stolidobranchia", align=T, offset=.5, color='brown') + geom_cladelabel(node=29, label="Phlebobranchia", align=T, offset=.5, color='green') + geom_cladelabel(node=28, label="Aplousobranchia", align=T, offset=.5, color='blue') + geom_cladelabel(node=32, label="Thaliacea", align=T, offset=.5, color='red') + geom_cladelabel(node=24, label="Appendicularia", align=T, offset=.5, color='pink') + geom_cladelabel(node=42, label="Vertebrata", align=T, offset=.5, color='grey') + geom_cladelabel(node=21, label="Cephalochordata", align=T, offset=.5, color='grey') + geom_tippoint(aes(size=Total))
reference  <- ggtree(nwk) + geom_tiplab(size=5, color="black", aes(size=Total)) + geom_text2(aes(subset=!isTip, label=Total, hjust=-.3, size=3))
reference <- reference %<+% dd
reference + geom_text(color='green', aes(label=Gains), hjust=1, vjust=-0.4, size=6) + geom_text(color='red', aes(label=Loss), hjust=1, vjust=1.4, size=6) + geom_cladelabel(node=33, label="Stolidobranchia", align=T, offset=.5, color='brown') + geom_cladelabel(node=29, label="Phlebobranchia", align=T, offset=.5, color='green') + geom_cladelabel(node=28, label="Aplousobranchia", align=T, offset=.5, color='blue') + geom_cladelabel(node=32, label="Thaliacea", align=T, offset=.5, color='red') + geom_cladelabel(node=24, label="Appendicularia", align=T, offset=.5, color='pink') + geom_cladelabel(node=42, label="Vertebrata", align=T, offset=.5, color='grey') + geom_cladelabel(node=21, label="Cephalochordata", align=T, offset=.5, color='grey') + geom_tippoint(aes(size=Total))
?geom_text2
reference  <- ggtree(nwk) + geom_tiplab(size=5, color="black")) + geom_text2(aes(subset=!isTip, label=Total, hjust=-.3, size=5))
reference  <- ggtree(nwk) + geom_tiplab(size=5, color="black") + geom_text2(aes(subset=!isTip, label=Total, hjust=-.3, size=5))
reference <- reference %<+% dd
reference + geom_text(color='green', aes(label=Gains), hjust=1, vjust=-0.4, size=6) + geom_text(color='red', aes(label=Loss), hjust=1, vjust=1.4, size=6) + geom_cladelabel(node=33, label="Stolidobranchia", align=T, offset=.5, color='brown') + geom_cladelabel(node=29, label="Phlebobranchia", align=T, offset=.5, color='green') + geom_cladelabel(node=28, label="Aplousobranchia", align=T, offset=.5, color='blue') + geom_cladelabel(node=32, label="Thaliacea", align=T, offset=.5, color='red') + geom_cladelabel(node=24, label="Appendicularia", align=T, offset=.5, color='pink') + geom_cladelabel(node=42, label="Vertebrata", align=T, offset=.5, color='grey') + geom_cladelabel(node=21, label="Cephalochordata", align=T, offset=.5, color='grey') + geom_tippoint(aes(size=Total))
?geom_tiplab
reference  <- ggtree(nwk) + geom_tiplab(size=5, color="black") + geom_text2(aes(subset=!isTip, label=Total, hjust=-.3, size=5)) + geom_label(aes(label=Total))
reference <- reference %<+% dd
reference + geom_text(color='green', aes(label=Gains), hjust=1, vjust=-0.4, size=6) + geom_text(color='red', aes(label=Loss), hjust=1, vjust=1.4, size=6) + geom_cladelabel(node=33, label="Stolidobranchia", align=T, offset=.5, color='brown') + geom_cladelabel(node=29, label="Phlebobranchia", align=T, offset=.5, color='green') + geom_cladelabel(node=28, label="Aplousobranchia", align=T, offset=.5, color='blue') + geom_cladelabel(node=32, label="Thaliacea", align=T, offset=.5, color='red') + geom_cladelabel(node=24, label="Appendicularia", align=T, offset=.5, color='pink') + geom_cladelabel(node=42, label="Vertebrata", align=T, offset=.5, color='grey') + geom_cladelabel(node=21, label="Cephalochordata", align=T, offset=.5, color='grey') + geom_tippoint(aes(size=Total))
?geom_label
reference  <- ggtree(nwk) + geom_tiplab(size=5, color="black") + geom_label(aes(label=Total))
reference <- reference %<+% dd
reference + geom_text(color='green', aes(label=Gains), hjust=1, vjust=-0.4, size=6) + geom_text(color='red', aes(label=Loss), hjust=1, vjust=1.4, size=6) + geom_cladelabel(node=33, label="Stolidobranchia", align=T, offset=.5, color='brown') + geom_cladelabel(node=29, label="Phlebobranchia", align=T, offset=.5, color='green') + geom_cladelabel(node=28, label="Aplousobranchia", align=T, offset=.5, color='blue') + geom_cladelabel(node=32, label="Thaliacea", align=T, offset=.5, color='red') + geom_cladelabel(node=24, label="Appendicularia", align=T, offset=.5, color='pink') + geom_cladelabel(node=42, label="Vertebrata", align=T, offset=.5, color='grey') + geom_cladelabel(node=21, label="Cephalochordata", align=T, offset=.5, color='grey') + geom_tippoint(aes(size=Total))
reference + geom_text(color='green', aes(label=Gains), hjust=0.5, vjust=-0.4, size=5) + geom_text(color='red', aes(label=Loss), hjust=0.5, vjust=1.4, size=6) + geom_cladelabel(node=33, label="Stolidobranchia", align=T, offset=.5, color='brown') + geom_cladelabel(node=29, label="Phlebobranchia", align=T, offset=.5, color='green') + geom_cladelabel(node=28, label="Aplousobranchia", align=T, offset=.5, color='blue') + geom_cladelabel(node=32, label="Thaliacea", align=T, offset=.5, color='red') + geom_cladelabel(node=24, label="Appendicularia", align=T, offset=.5, color='pink') + geom_cladelabel(node=42, label="Vertebrata", align=T, offset=.5, color='grey') + geom_cladelabel(node=21, label="Cephalochordata", align=T, offset=.5, color='grey') + geom_tippoint(aes(size=Total))
reference + geom_text(color='green', aes(label=Gains), hjust=1.5, vjust=-0.4, size=6) + geom_text(color='red', aes(label=Loss), hjust=1.5, vjust=1.4, size=6) + geom_cladelabel(node=33, label="Stolidobranchia", align=T, offset=.5, color='brown') + geom_cladelabel(node=29, label="Phlebobranchia", align=T, offset=.5, color='green') + geom_cladelabel(node=28, label="Aplousobranchia", align=T, offset=.5, color='blue') + geom_cladelabel(node=32, label="Thaliacea", align=T, offset=.5, color='red') + geom_cladelabel(node=24, label="Appendicularia", align=T, offset=.5, color='pink') + geom_cladelabel(node=42, label="Vertebrata", align=T, offset=.5, color='grey') + geom_cladelabel(node=21, label="Cephalochordata", align=T, offset=.5, color='grey') + geom_tippoint(aes(size=Total))
reference  <- ggtree(nwk) + geom_tiplab(size=5, color="black") + geom_label(size=6, aes(label=Total))
reference <- reference %<+% dd
reference + geom_text(color='green', aes(label=Gains), hjust=1.5, vjust=-0.4, size=6) + geom_text(color='red', aes(label=Loss), hjust=1.5, vjust=1.4, size=6) + geom_cladelabel(node=33, label="Stolidobranchia", align=T, offset=.5, color='brown') + geom_cladelabel(node=29, label="Phlebobranchia", align=T, offset=.5, color='green') + geom_cladelabel(node=28, label="Aplousobranchia", align=T, offset=.5, color='blue') + geom_cladelabel(node=32, label="Thaliacea", align=T, offset=.5, color='red') + geom_cladelabel(node=24, label="Appendicularia", align=T, offset=.5, color='pink') + geom_cladelabel(node=42, label="Vertebrata", align=T, offset=.5, color='grey') + geom_cladelabel(node=21, label="Cephalochordata", align=T, offset=.5, color='grey') + geom_tippoint(aes(size=Total))
reference + geom_text(color='green', aes(label=Gains), hjust=2, vjust=-0.4, size=5) + geom_text(color='red', aes(label=Loss), hjust=2, vjust=1.4, size=5) + geom_cladelabel(node=33, label="Stolidobranchia", align=T, offset=.5, color='brown') + geom_cladelabel(node=29, label="Phlebobranchia", align=T, offset=.5, color='green') + geom_cladelabel(node=28, label="Aplousobranchia", align=T, offset=.5, color='blue') + geom_cladelabel(node=32, label="Thaliacea", align=T, offset=.5, color='red') + geom_cladelabel(node=24, label="Appendicularia", align=T, offset=.5, color='pink') + geom_cladelabel(node=42, label="Vertebrata", align=T, offset=.5, color='grey') + geom_cladelabel(node=21, label="Cephalochordata", align=T, offset=.5, color='grey') + geom_tippoint(aes(size=Total))
reference + geom_text(color='green', aes(label=Gains), hjust=3, vjust=-0.4, size=5) + geom_text(color='red', aes(label=Loss), hjust=3, vjust=1.4, size=5) + geom_cladelabel(node=33, label="Stolidobranchia", align=T, offset=.5, color='brown') + geom_cladelabel(node=29, label="Phlebobranchia", align=T, offset=.5, color='green') + geom_cladelabel(node=28, label="Aplousobranchia", align=T, offset=.5, color='blue') + geom_cladelabel(node=32, label="Thaliacea", align=T, offset=.5, color='red') + geom_cladelabel(node=24, label="Appendicularia", align=T, offset=.5, color='pink') + geom_cladelabel(node=42, label="Vertebrata", align=T, offset=.5, color='grey') + geom_cladelabel(node=21, label="Cephalochordata", align=T, offset=.5, color='grey') + geom_tippoint(aes(size=Total))
reference  <- ggtree(nwk) + geom_tiplab(size=7, color="black") + geom_label(size=6, aes(label=Total))
reference <- reference %<+% dd
reference + geom_text(color='green', aes(label=Gains), hjust=3, vjust=-0.4, size=5) + geom_text(color='red', aes(label=Loss), hjust=3, vjust=1.4, size=5) + geom_cladelabel(node=33, label="Stolidobranchia", align=T, offset=.5, color='brown') + geom_cladelabel(node=29, label="Phlebobranchia", align=T, offset=.5, color='green') + geom_cladelabel(node=28, label="Aplousobranchia", align=T, offset=.5, color='blue') + geom_cladelabel(node=32, label="Thaliacea", align=T, offset=.5, color='red') + geom_cladelabel(node=24, label="Appendicularia", align=T, offset=.5, color='pink') + geom_cladelabel(node=42, label="Vertebrata", align=T, offset=.5, color='grey') + geom_cladelabel(node=21, label="Cephalochordata", align=T, offset=.5, color='grey') + geom_tippoint(aes(size=Total))
reference + geom_text(color='green', aes(label=Gains), hjust=3, vjust=-0.4, size=5) + geom_text(color='red', aes(label=Loss), hjust=3, vjust=1.4, size=5) + geom_cladelabel(node=33, label="Stolidobranchia", align=T, offset=.8, color='brown') + geom_cladelabel(node=29, label="Phlebobranchia", align=T, offset=.8, color='green') + geom_cladelabel(node=28, label="Aplousobranchia", align=T, offset=.8, color='blue') + geom_cladelabel(node=32, label="Thaliacea", align=T, offset=.8, color='red') + geom_cladelabel(node=24, label="Appendicularia", align=T, offset=.8, color='pink') + geom_cladelabel(node=42, label="Vertebrata", align=T, offset=.8, color='grey') + geom_cladelabel(node=21, label="Cephalochordata", align=T, offset=.8, color='grey') + geom_tippoint(aes(size=Total))
reference + geom_text(color='green', aes(label=Gains), hjust=3, vjust=-0.4, size=5) + geom_text(color='red', aes(label=Loss), hjust=3, vjust=1.4, size=5) + geom_cladelabel(node=33, label="Stolidobranchia", align=T, offset=.8, color='brown') + geom_cladelabel(node=29, label="Phlebobranchia", align=T, offset=.8, color='green') + geom_cladelabel(node=28, label="Aplousobranchia", align=T, offset=.8, color='blue') + geom_cladelabel(node=32, label="Thaliacea", align=T, offset=.8, color='red') + geom_cladelabel(node=24, label="Appendicularia", align=T, offset=.8, color='pink') + geom_cladelabel(node=42, label="Vertebrata", align=T, offset=.8, color='grey') + geom_cladelabel(node=21, label="Cephalochordata", align=T, offset=.8, color='grey')
reference + geom_text(color='green', aes(label=Gains), hjust=3, vjust=-0.4, size=5) + geom_text(color='red', aes(label=Loss), hjust=3, vjust=1.4, size=5) + geom_cladelabel(node=33, label="Stolidobranchia", align=T, offset=.8, color='brown') + geom_cladelabel(node=29, label="Phlebobranchia", align=T, offset=.8, color='green') + geom_cladelabel(node=28, label="Aplousobranchia", align=T, offset=.8, color='blue') + geom_cladelabel(node=32, label="Thaliacea", align=T, offset=.8, color='red') + geom_cladelabel(node=24, label="Appendicularia", align=T, offset=.8, color='pink') + geom_cladelabel(node=42, label="Vertebrata", align=T, offset=.8, color='grey') + geom_cladelabel(node=21, label="Cephalochordata", align=T, offset=.8, color='grey', size=6)
dd <- read.table("data_table_program_count", header=T)reference  <- ggtree(nwk) + geom_tiplab(size=7, color="black") + geom_label(size=6, aes(label=Total))
reference <- reference %<+% dd
nwk <- read.tree("metazoa.Ensembl.Bilateria.nwk")
dd <- read.table("data_table_program_count", header=T)
reference  <- ggtree(nwk) + geom_tiplab(size=7, color="black") + geom_label(size=6, aes(label=Total))
reference <- reference %<+% dd
reference <- reference %<+% dd
dd
nwk <- read.tree("metazoa.Ensembl.Bilateria.nwk")
nwk
nwk <- read.tree("metazoa.Ensembl.Bilateria_final.nwk")
nwk <- read.tree("metazoa.Ensembl.Bilateria_final.nwk")
dd <- read.table("data_table_program_count", header=T)
reference  <- ggtree(nwk) + geom_tiplab(size=7, color="black") + geom_label(size=6, aes(label=Total))
reference <- reference %<+% dd
reference
reference  <- ggtree(nwk, aes(color=Group)) + geom_tiplab(size=7, color="black") + geom_label(size=6, aes(label=Total))
reference
dd <- read.table("data_table_program_count", header=T)
reference <- reference %<+% dd
reference
dd <- read.table("data_table_program_count", header=T)
reference <- reference %<+% dd
reference  <- ggtree(nwk, aes(color=Group)) + geom_tiplab(size=7, color="black") + geom_label(size=6, aes(label=Total))
dd <- read.table("data_table_program_count", header=T)
reference <- reference %<+% dd
reference
reference + theme(legend.position="rigth")
reference + theme(legend.position="right")
reference + scale_color_brewer() + theme(legend.position="right")
reference + scale_color_brewer(palette="Dark2") + theme(legend.position="right")
reference + scale_color_brewer(palette="Set3") + theme(legend.position="right")
reference + scale_color_brewer(palette="Paired") + theme(legend.position="right")
dd <- read.table("data_table_program_count", header=T)
reference  <- ggtree(nwk, aes(color=Group)) + geom_tiplab(size=7, color="black") + geom_label(size=6, aes(label=Total))
reference <- reference %<+% dd
reference + scale_color_brewer(palette="Set1") + theme(legend.position="right")
reference + scale_color_brewer(palette="Set2") + theme(legend.position="right")
reference + theme(legend.position="right")
reference + scale_color_brewer(palette="Spectral") + theme(legend.position="right")
reference + theme(legend.position="right")
reference + scale_color_brewer(palette="Spectral") + theme(legend.position="right")
reference + scale_color_brewer(palette="Spectral") + theme(legend.position="left")
reference + scale_color_brewer(palette="Spectral") + theme(legend.position="right")
reference + theme(legend.position="right")
reference  <- ggtree(nwk, aes(color=Group)) + geom_tiplab(size=7, color="black") + geom_label(size=6, aes(label=Total)) + theme(legend.position="right")
reference + geom_text(color='green', aes(label=Gains), hjust=3, vjust=-0.4, size=5) + geom_text(color='red', aes(label=Loss), hjust=3, vjust=1.4, size=5) + geom_cladelabel(node=23, label="Tunicata", align=T, offset=.8, color='brown') + geom_cladelabel(node=42, label="Vertebrata", align=T, offset=.8, color='grey') + geom_cladelabel(node=21, label="Cephalochordata", align=T, offset=.8, color='grey', size=6)
dd <- read.table("data_table_program_count", header=T)
reference <- reference %<+% dd
reference + geom_text(color='green', aes(label=Gains), hjust=3, vjust=-0.4, size=5) + geom_text(color='red', aes(label=Loss), hjust=3, vjust=1.4, size=5) + geom_cladelabel(node=23, label="Tunicata", align=T, offset=.8, color='brown') + geom_cladelabel(node=42, label="Vertebrata", align=T, offset=.8, color='grey') + geom_cladelabel(node=21, label="Cephalochordata", align=T, offset=.8, color='grey', size=6)
reference + geom_text(color='green', aes(label=Gains), hjust=3, vjust=-0.4, size=5) + geom_text(color='red', aes(label=Loss), hjust=3, vjust=1.4, size=5) + geom_cladelabel(node=23, label="Tunicata", align=T, offset=.8, color='brown') + geom_cladelabel(node=42, label="Vertebrata", align=T, offset=.8, color='grey') + geom_cladelabel(node=21, label="Cephalochordata", align=T, offset=.8, color='grey', fontsize=6)
reference + geom_text(color='green', aes(label=Gains), hjust=3, vjust=-0.4, size=5) + geom_text(color='red', aes(label=Loss), hjust=3, vjust=1.4, size=5) + geom_cladelabel(node=23, label="Tunicata", align=T, offset=.8, color='darkblue', fontsize=5) + geom_cladelabel(node=42, label="Vertebrata", align=T, offset=.8, color='grey', fontsize=5) + geom_cladelabel(node=21, label="Cephalochordata", align=T, offset=.8, color='grey', fontsize=5)
reference + geom_text(color='green', aes(label=Gains), hjust=3, vjust=-0.4, size=5) + geom_text(color='red', aes(label=Loss), hjust=3, vjust=1.4, size=5) + geom_cladelabel(node=23, label="Tunicata", align=T, offset=.8, color='darkblue', fontsize=5) + geom_cladelabel(node=42, label="Vertebrata", align=T, offset=.8, color='grey', fontsize=5) + geom_cladelabel(node=21, label="Cephalochordata", align=T, offset=.8, color='grey', fontsize=5)
reference + geom_text(color='green', aes(label=Gains), hjust=3, vjust=-0.4, size=5) + geom_text(color='red', aes(label=Loss), hjust=3, vjust=1.4, size=5) + geom_cladelabel(node=23, label="Tunicata", align=T, offset=.8, color='darkblue', fontsize=5) + geom_cladelabel(node=42, label="Vertebrata", align=T, offset=.8, color='grey', fontsize=5) + geom_cladelabel(node=21, label="Cephalochordata", align=T, offset=.8, color='grey', fontsize=5, angle=35)
reference + geom_text(color='green', aes(label=Gains), hjust=3, vjust=-0.4, size=5) + geom_text(color='red', aes(label=Loss), hjust=3, vjust=1.4, size=5) + geom_cladelabel(node=23, label="Tunicata", align=T, offset=.8, color='darkblue', fontsize=5, angle=35) + geom_cladelabel(node=42, label="Vertebrata", align=T, offset=.8, color='grey', fontsize=5, angle=35) + geom_cladelabel(node=21, label="Cephalochordata", align=T, offset=.8, color='grey', fontsize=5, angle=35)
reference + geom_text(color='green', aes(label=Gains), hjust=3, vjust=-0.4, size=5) + geom_text(color='red', aes(label=Loss), hjust=3, vjust=1.4, size=5) + geom_cladelabel(node=23, label="Tunicata", align=T, offset=.8, color='darkblue', fontsize=5, angle=35) + geom_cladelabel(node=42, label="Vertebrata", align=T, offset=.8, color='grey', fontsize=5, angle=35) + geom_cladelabel(node=21, label="Cephalochordata", align=T, offset=.8, color='grey', fontsize=3, angle=35)
reference + geom_text(color='green', aes(label=Gains), hjust=3, vjust=-0.4, size=5) + geom_text(color='red', aes(label=Loss), hjust=3, vjust=1.4, size=5) + geom_cladelabel(node=23, label="Tunicata", align=T, offset=.8, color='darkblue', fontsize=5, angle=35) + geom_cladelabel(node=42, label="Vertebrata", align=T, offset=.8, color='grey', fontsize=5, angle=35) + geom_cladelabel(node=21, label="Cephalochordata", align=T, offset=.8, color='grey', fontsize=5)
reference + geom_text(color='green', aes(label=Gains), hjust=3, vjust=-0.4, size=5) + geom_text(color='red', aes(label=Loss), hjust=3, vjust=1.4, size=5) + geom_cladelabel(node=23, label="Tunicata", align=T, offset=.8, color='darkblue', fontsize=5, angle=35) + geom_cladelabel(node=42, label="Vertebrata", align=T, offset=.8, color='grey', fontsize=5, angle=35) + geom_cladelabel(node=21, label="Cephalochordata", align=T, offset=.8, color='grey', fontsize=5, angle=20)
nwk <- read.tree("metazoa.Ensembl.Bilateria_final.nwk")
dd <- read.table("data_table_program_count", header=T)
reference  <- ggtree(nwk) + geom_tiplab(size=7, color="black") + geom_lab
reference  <- ggtree(nwk) + geom_tiplab(size=7, color="black") + geom_label(size=6, aes(label=Total)) + theme(legend.position="right")
reference <- reference %<+% dd
reference + geom_text(color='green', aes(label=Gains), hjust=3, vjust=-0.4, size=5) + geom_text(color='red', aes(label=Loss), hjust=3, vjust=1.4, size=5)+ geom_cladelabel(node=23, label="Tunicata", align=T, offset=.8, color='darkblue', fontsize=5, angle=35) + geom_cladelabel(node=42, label="Vertebrata", align=T, offset=.8, color='grey', fontsize=5, angle=35) + geom_cladelabel(node=21, label="Cephalochordata", align=T, offset=.8, color='grey', fontsize=5, angle=20)
reference  <- ggtree(nwk, color=Clade) + geom_tiplab(size=7, color="black") + geom_label(size=6, aes(label=Total)) + theme(legend.position="right")
nwk <- read.tree("metazoa.Ensembl.Bilateria_final.nwk")
dd <- read.table("data_table_program_count", header=T)
reference  <- ggtree(nwk, color=Clade) + geom_tiplab(size=7, color="black") + geom_label(size=6, aes(label=Total)) + theme(legend.position="right")
reference <- reference %<+% dd
reference <- reference %<+% dd
nwk <- read.tree("metazoa.Ensembl.Bilateria_final.nwk")
dd <- read.table("data_table_program_count", header=T)
reference  <- ggtree(nwk, aes(color=Clade)) + geom_tiplab(size=7, color="black") + geom_label(size=6, aes(label=Total))
reference  <- ggtree(nwk, aes(color=Clade)) + geom_tiplab(size=7, color="black") + geom_label(size=6, aes(label=Total)) + theme(legend.position="right")
reference <- reference %<+% dd
reference + geom_text(color='green', aes(label=Gains), hjust=3, vjust=-0.4, size=5) + geom_text(color='red', aes(label=Loss), hjust=3, vjust=1.4, size=5)+ geom_cladelabel(node=23, label="Tunicata", align=T, offset=.8, color='darkblue', fontsize=5, angle=35) + geom_cladelabel(node=42, label="Vertebrata", align=T, offset=.8, color='grey', fontsize=5, angle=35) + geom_cladelabel(node=21, label="Cephalochordata", align=T, offset=.8, color='grey', fontsize=5, angle=20)
ggsave("test.pdf")
quit()
